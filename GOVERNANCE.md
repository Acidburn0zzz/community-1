# Governance Constitution

## Overview

Harbor is committed to building an open, evolutionary, high-efficiency and self-governance OSS community to provide cloud-native registry relevant tools and services. The whole community is run and managed by this constitution including the following chapters:

* **Code Repositories:** List the code repositories governed by Harbor community.
* **Community Roles:** Define roles of harbor community affiliated parties.
* **Technical Maintainer Board:** Define how to build and how does the technical maintainer board work, which is the top management institutions of the whole community.
* **Proposal Management:** How to manage the proposals and plan the new release.
* **Community Project Management:** Define the process to handle the community projects on top of harbor project.

## Code Repositories
So far, the following code repositories are governed by Harbor community and maintained under the `goharbor` namespace.

* **harbor:** The code base of Harbor registry project.
* **harbor-helm:** The helm chart of the Harbor registry.
* **community:** A repository to keep community related material like proposals, introduction slides, community governance documents and community meeting minutes etc.

## Community Roles

The participants of harbor community may have different roles:

* **User**
  * User IS a person or an organization adopting and using Harbor as cloud-native registry.
* **Partner**
  * Partner MUST be a Harbor user first.
  * Partner MUST be an organization which is listed in the PARTNER.md document.
  * Partner HAS signed the brand usage authorization contact.
* **Contributor**
  * Contributor is a GitHub user who HAS submitted at least one commit to harbor repositories.
* **Active Contributor**
  * Active contributor MUST be a contributor first.
  * Active contributor SHOULD have continuous contributions in a reasonable period.
  * Active contributor SHOULD be top **30** in the GitHub contributor rank list.
* **Maintainer**
  * Member of TMB
  * Maintainer MUST be a active contributor
  * Maintainer SHOULD be senior engineers (>5 service years)
  * Generated by the nomination process.

## Technical Maintainer Board (TMB)

Technical maintainer board (TMB) is the top management institutions of the whole harbor community. TMB carries the mission of promoting and strengthening the community, grasps the development direction of the community and maintains the healthy growth of the community.

### Responsibilities

* Define and review the mission/roadmap of the project(s)
* Define and review the release plan
* Define and review the governance model/workflow of the community
* Review the tech proposals from community
* Review and approve PRs
* Review the maintainer joining requests
* Host the community calls
* Any other community-related stuff needs decision making

### Scale and Structure

* Formed by `M+N` members
  * N is an odd number between **5** and **15**, which is the total number of `maintainer`
    * `maintainer` has full privileges of participating TMB activities
  * M is the total number of `watcher`, no limitation
    * `watcher` has limited privileges of participating TMB activities. They're in the pre-stage of becoming a formal maintainer. Follow and learn.
* **1** convener who takes charge of coordinating the TMB activities.  

### Work Process

* Voting is the primary way to make decision in TMB
  * Each `maintainer` of TMB has **1** vote
  * `Watcher` has no vote
  * A review request can be approved only and only if **2/3** members vote `YES`
* Follow the below process to review community topics
  * Convener or a maintainer originates a review request with any of the following ways
    * TMB IM channel (private slack channel #harbor-maintainers under CNCF workspace)
    * TMB maillist (harbor-maintainers@googlegroups.com)
    * TMB Regular calls
  * Discuss and comment the review request
  * Launch a vote activity and collect voting results by the request originator
  * Update the status of the request to represent the right voting result
* Meet in TMB Regular calls and discuss general topics if necessary

### Membership

* New member
  * Nominated by existing member as a `maintainer` or `watcher` candidate
  * Nomination is approved if getting **2/3** votes from the TMB
* Membership ending
  * Quit by notifying the board with mails
  * Persuade to quit if criteria is broken
* Tenure
  * Full period is **1** year
* Document
  * Memberships of maintainers are stored in the (MAINTAINER.md)[] document
* Renew
  * If membership of one maintainer is ended in advance,
    * Select a replacement candidate from the `watcher` list and **2/3** votes SHOULD be got after reviewing
    * If no candidate in the `watcher` list, nominate 1 candidate from the active contributor list and **2/3** votes SHOULD be got after reviewing
    * The replacement maintainer inherits the left membership tenure from the quitting maintainer
  * If the full tenure is ended and the maintainer is still willing to be in,
    * Renew the membership after getting **2/3** votes in the review

## Proposal Management

Proposal is the only way to request applying changes to the projects governed by the harbor community. The project release plans should also be built based on the `accepted` proposals.

### Scope

A proposal can cover one of the following different kinds of change requests:

* Changes/enhancements to the existing features
* New feature
* System integration
* Additional tools
* Other innovation ideas

### Template

Each proposal should include clear and concrete descriptions of the following topics:

* Header
  * The authors of the proposal
    * GitHub ID
    * email
    * company name if have
  * The created time stamp
  * The last updated time stamp
  * The `epic` issue link with number if it is already under development
  * The development team if it is already under development
* The motivations of or the related problem to the proposal
* The background of the proposal
* The main idea of the proposal solution
* The architecture/design of the proposal solution
* The development plan of the proposal solution
* The resource plan of developing the proposal solution
* Additional contexts related with the proposal

Here is a good [proposal example](https://github.com/nlowe/harbor-tag-retention-proposal/blob/master/README.md).

### Format

The proposal should be documented as a separated markdown file containing the relevant sections described in the above [Template](#template) chapter and pushed to the `proposals` folder in the [community](https://github.com/goharbor/community) repository via PR. The name of the file should follow the name pattern `<short meaningful words joined by '-'>_proposal.md`, e.g: `clear-old-tags-with-policies_proposal.md`.

### Work flow

To raise a proposal,

* Fork the [community](https://github.com/goharbor/community) repository to your namespace if you have not do that yet
* Sync the main branch of your forked repository with the upstream repository to confirm merging the latest updates
* Create a new branch to track your work
* Create a new markdown file with a proper name and complete the contents by following the above specs defined in [Template](#template)
* Raise a new PR to the upstream `master` branch with proper comments

The TMB will pick up the submitted PR at proper time and start the discussion and reviewing process. The related comments will be posted under the PR. The authors of the proposal should continuously apply changes to the PR if required by the TMB and the authors accept it. If authors have different opinions, they can discuss it with the TMD in the comment threads of the PR.

The proposal PR can be marked with different status labels to represent the status of the proposal:

* **New**: Proposal is just created
* **Reviewing**: Proposal is under reviewing and discussion
* **Accepted**: Proposal is reviewed and voted to accept
* **Rejected**: Proposal is reviewed but not enough votes got

If the status is marked to `Accepted`, the PR will be merged into the upstream repository and the proposal document is archived.

If the status is marked to `Rejected`, the PR will be directly closed, the proposal will be discarded.

If the `Accepted` proposal is pick up by community contributors to do the development work, a 'epic' issue should be created to drill down and track the related development tasks. The issue info should be updated to the proposal document.

If the proposal is successfully implemented and delivered, the related proposal document should be moved to the `delivered` sub folder under the `proposal` folder. Proposal being delivered means:

* The implemented code is merged to the branches of the governed repositories via PRs
* Or it is implemented as an independent [community project](#community-project-management) and linked in the official website and README files as additional tools

If the proposal is failed to deliver for some reasons, the related proposal document should be moved to the `failed` sub folder under the `proposal` folder.

The proposals under the root of the `proposal` folder can be treated as a proposal pool, community contributors can pick up from this pool if they want to do contributions to harbor community when creating the release plan.

Adhoc picking up should not be supported now.

## Community Project Management

A community project is an independent repository under an external namespace and maintained by the owners themselves. The community project contains the implementation of one specified proposal but the implementation can not be merged or integrated as native feature for some reasons so far. It will be run as an additional external tools to provide some extended capabilities on top of the governed projects.

## Basic flow

Once the development work of the community project is finished and ready to be published to the community for trying,

* Raise a PR to update the [Additional Tools](https://github.com/goharbor/harbor#additional-tools) section in the [harbor](https://github.com/goharbor/harbor) repository by appending the contents with below pattern.

```
* [name of the community project](link of repo url)
  * <The main feature this project provides>
  * Lead by <GitHub ID of the author> from <company name>
```

* The TMB will review the PR and make decision via voting
* If voting passed (**2/3 YES**), the updates will be merged. That means the project is onboared to harbor community
* If voting failed, the onboarding request will be rejected. PR will be directly closed. 
